!function($){function I18n(options){options||(options={}),void 0===options.cache&&(options.cache=!0),this.baseLang=options.baseLang||"zh-CN",this.cache=options.cache,this.baseUrl=options.baseUrl,this.cb=options.callback,this.lang="",this.locale={},this.storeKey={lang:"LANGUAGE"},this.getStorage=function(name){return localStorage.getItem(name)},this.setStorage=function(key,val){return localStorage.setItem(key,val)}}function getLevelVal(key,obj){var text=obj[key],regexp,level=[];if(!text)if(/\./g.test(key)){level=key.split(".");for(var prevObj=obj,i=0;i<level.length;i++){var item=level[i];if(prevObj[item]){var val=prevObj[item];if("object"!=typeof val){text=val;break}prevObj=val}}}else text=key;return text}I18n.prototype.initLang=function(cb){var lang=this.getStorage(this.storeKey.lang);$("html").attr("lang",lang),this.lang=lang||this.baseLang,this.cacheLang(),this.load(cb||void 0)},I18n.prototype.cacheLang=function(){this.setStorage(this.storeKey.lang,this.lang)},I18n.prototype.load=function(cb){var _this=this,url=this.baseUrl+this.lang+".json";this.cache||(url=url+"?t="+Date.now()),$.getJSON(url,(function(data,textStatus,jqXHR){_this.locale=data,_this.changeNodeText(),_this.changeNodePlaceholder(),_this.changeNodeSrc(),_this.changeNodeValue(),cb&&cb(_this.lang)}))},I18n.prototype.changeLocale=function(lang){lang!==this.lang&&($("html").attr("lang",lang),this.lang=lang,this.cb&&this.cb(this.lang),this.call,this.load(),this.cacheLang())},I18n.prototype.changeNodeText=function(){var _this=this;$("[i18n-text]").each((function(i,node){var curNode=$(this),key=$(this).attr("i18n-text");curNode.text(getLevelVal(key,_this.locale))}))},I18n.prototype.changeNodePlaceholder=function(){var _this=this;$("[i18n-placeholder]").each((function(i,node){var curNode=$(this),key=$(this).attr("i18n-placeholder");curNode.attr("placeholder",getLevelVal(key,_this.locale))}))},I18n.prototype.changeNodeSrc=function(){var _this=this;$("[i18n-src]").each((function(i,node){var curNode=$(this),key=$(this).attr("i18n-src");curNode.attr("src",getLevelVal(key,_this.locale))}))},I18n.prototype.changeNodeValue=function(){var _this=this;$("[i18n-value]").each((function(i,node){var curNode=$(this),key=$(this).attr("i18n-value");curNode.attr("value",getLevelVal(key,_this.locale))}))},I18n.prototype.$t=function(key){return getLevelVal(key,this.locale)},$.I18n=I18n}($);